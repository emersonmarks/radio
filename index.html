<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R√°dios do Brasil - Responsivo</title>

<style>
*{ box-sizing: border-box; }

body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #fff;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
}

h1 { margin: 20px 0 10px 0; }

/* Player */
#playerContainer {
    position: sticky;
    top: 0;
    background: #1e1e1e;
    width: 100%;
    max-width: 500px;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    text-align: center;
    box-shadow: 0 0 10px #000;
    z-index: 5;
    display: none;
}

#radioEscolhida {
    display: flex;
    align-items: center;
}

#currentLogo {
    width: 60px;
    height: 60px;
    object-fit: contain;
    border-radius: 8px;
    background: #fff;
}

#currentStation { margin-left: 10px; }

audio { width: 100%; margin-top: 5px; }

/* Filtros */
#filters {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 20px;
    justify-content: center;
}

input, select, button {
    padding: 8px;
    border-radius: 4px;
    border: none;
    background: #1e1e1e;
    color: #fff;
}

input { width: 220px; }

button {
    background: #ff6f61;
    cursor: pointer;
}

button:hover { background: #ff3b2f; }

/* An√∫ncios */
.ad-top, .ad-bottom {
    width: 1200px;
    max-width: 90%;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 15px 0;
    text-align: center;
}

.ad-side {
    width: 120px;
    background: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 10px;
    position: sticky;
    top: 120px;
}

/* Layout */
.main-container {
    display: flex;
    width: 100%;
    max-width: 1400px;
    justify-content: center;
}

.content {
    flex: 1;
    padding: 0 20px;
}

/* Lista */
#stations {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
}

.station {
    background: #1e1e1e;
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    position: relative;
}

.station:hover { background: #333; }

.station img {
    width: 80px;
    height: 80px;
    background: #fff;
    border-radius: 8px;
    object-fit: contain;
}

.fav-icon {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 24px;
    cursor: pointer;
}

.favorited { color: #ff0; }

@media (max-width: 1000px) {
    .ad-side { display: none; }
}

@media (max-width: 540px) {
    #filters { flex-direction: column; }
    input, select, button { width: 100%; }
}
</style>
</head>

<body>

<h1>üéµ R√°dios do Brasil</h1>

<!-- Player -->
<div id="playerContainer">
    <div id="radioEscolhida">
        <img id="currentLogo">
        <h3 id="currentStation"></h3>
    </div>
    <audio id="radioPlayer" controls autoplay></audio>
</div>

<!-- Filtros -->
<div id="filters">
    <input id="searchInput" placeholder="Buscar por nome">
    <select id="stateSelect"><option value="">Todos os estados</option></select>
    <select id="categorySelect"><option value="">Todas as categorias</option></select>
    <button onclick="applyFilters()">Buscar</button>
    <button onclick="showFavorites()">‚≠ê Favoritos</button>
</div>

<!-- An√∫ncio Topo -->
<div class="ad-top" id="ad-top"></div>

<div class="main-container">
    <div class="ad-side">Lateral</div>
    <div class="content">
        <div id="stations"></div>
    </div>
    <div class="ad-side">Lateral</div>
</div>

<!-- An√∫ncio Rodap√© -->
<div class="ad-bottom" id="ad-bottom"></div>

<script>
const API_BASE = "https://de2.api.radio-browser.info/json";
const player = document.getElementById("radioPlayer");
const playerContainer = document.getElementById("playerContainer");
const currentLogo = document.getElementById("currentLogo");
const currentStation = document.getElementById("currentStation");
let favorites = JSON.parse(localStorage.getItem("favoriteStations") || "[]");

fetchStations();

async function fetchStations() {
    const r = await fetch(`${API_BASE}/stations/search?country=Brazil&limit=50`);
    const data = await r.json();
    renderStations(data);
}

function renderStations(stations) {
    const c = document.getElementById("stations");
    c.innerHTML = "";
    stations.forEach(s => {
        const d = document.createElement("div");
        d.className = "station";
        d.innerHTML = `
            <span class="fav-icon ${favorites.some(f=>f.stationuuid===s.stationuuid) ? 'favorited':''}">‚òÖ</span>
            <img src="${s.favicon || ''}">
            <h3>${s.name}</h3>
        `;
        d.onclick = () => playStation(s);
        d.querySelector(".fav-icon").onclick = e => {
            e.stopPropagation();
            toggleFavorite(s);
            renderStations(stations);
        };
        c.appendChild(d);
    });
}

function playStation(s) {
    currentLogo.src = s.favicon || "";
    currentStation.textContent = s.name;
    player.src = s.url_resolved;
    player.play();
    playerContainer.style.display = "block";
}

function toggleFavorite(s) {
    const i = favorites.findIndex(f => f.stationuuid === s.stationuuid);
    i >= 0 ? favorites.splice(i,1) : favorites.push(s);
    localStorage.setItem("favoriteStations", JSON.stringify(favorites));
}

function showFavorites() {
    favorites.length ? renderStations(favorites) : alert("Sem favoritos");
}

function applyFilters() {
    fetchStations();
}

/* ===== AN√öNCIOS ===== */

function loadTopAd() {
    const c = document.getElementById("ad-top");
    c.innerHTML = "";

    const s1 = document.createElement("script");
    s1.innerHTML = `
        atOptions = {
            'key' : '6b119b3b6aa653dcbe1e30654f66fc11',
            'format' : 'iframe',
            'height' : 60,
            'width' : 468,
            'params' : {}
        };
    `;

    const s2 = document.createElement("script");
    s2.src = "https://www.highperformanceformat.com/6b119b3b6aa653dcbe1e30654f66fc11/invoke.js";
    s2.async = true;

    c.appendChild(s1);
    c.appendChild(s2);
}

function loadBottomAd() {
    document.getElementById("ad-bottom").innerHTML =
        "[ Espa√ßo para an√∫ncio - 1200x90 ]";
}

loadTopAd();
loadBottomAd();

/* Atualiza SOMENTE an√∫ncios a cada 3 minutos */
setInterval(() => {
    loadTopAd();
    loadBottomAd();
}, 180000);
</script>

</body>
</html>
